<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Home Page</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">    <script src="/static/bootstrap-5.1.3/js/bootstrap.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <style>

    </style>
</head>
<body>
<nav class="navbar navbar-expand-lg bg-body-tertiary">
    <div class="container-fluid">
        <div class="col-8">
            <a th:href="@{/}" class="navbar-brand" >Quản lý khách hàng</a>
            <a th:href="@{/create}" class=" btn btn-success">Thêm mới</a>
        </div>
        <div class="col-4">
            <form class="d-flex" role="search">
                <input class="form-control me-2" type="search" name="valueSearch" placeholder="Search" aria-label="Search">
                <button class="btn btn-outline-success" type="submit">Search</button>
            </form>
        </div>
    </div>
</nav>
<h2 class="display-2 justify-content-center d-flex" style="color: green" th:text="${msg}"></h2>
<table class="table table-hover">
    <thead>
    <tr>
        <th>STT </th>
        <th>Tên</th>
        <th>Email</th>
        <th>Số điện thoại</th>
        <th>Thể loại</th>
        <th>Mô tả</th>
        <th>Action</th>
    </tr>
    </thead>
    <tbody>
    <tr th:each="customer, loop : ${customerList}">
        <td th:text="${loop.count}"></td>
        <td th:text="${customer.name}"></td>
        <td th:text="${customer.email}"></td>
        <td th:text="${customer.phoneNumber}"></td>
        <td th:text="${customer.phone.typePhone}"></td>
        <td th:text="${customer.phone.description}"></td>
        <td>
            <a type="button" class="btn btn-outline-warning" th:href="@{/update/{id}(id=${customer.id})}">Edit</a>
            <a type="button" th:href="@{/delete/{id}(id=${customer.id})}"  th:attr="onclick=|infoDelete('${customer.id}','${customer.name}')|" class="btn btn-sm btn-danger" data-bs-toggle="modal" data-bs-target="#exampleModal">
                Delete
            </a>
        </td>
    </tr>
    </tbody>
</table>
<th:block th:if="${customerList.isEmpty()}">
    <tr>
        <td colspan="7">
            <h2 th:text="'Hiện tại không có bệnh án nào'" style="color: red; text-align: center;"></h2>
        </td>
    </tr>
</th:block>

<!--<div style="text-align: center">-->
<!--    <a   th:href="@{/(page=${customerList.number - 1})}" th:if="${customerList.hasPrevious()}">Trang trước</a>-->

<!--    &lt;!&ndash;    Cách 1: &ndash;&gt;-->
<!--    &lt;!&ndash;    <span th:text="${list.number+1}"></span>/<span th:text="${list.totalPages}"></span>&ndash;&gt;-->

<!--    &lt;!&ndash;    Cách 2: &ndash;&gt;-->
<!--    <a th:each="i : ${#numbers.sequence(0, customerList.totalPages - 1)}" role="button"-->
<!--       class="btn btn-outline-primary" th:text="${i+1}"-->
<!--       th:href="@{/(page=${i})}"-->
<!--    ></a>-->

<!--    <a   th:href="@{/(page=${customerList.number + 1})}" th:if="${customerList.hasNext()}">Trang sau</a>-->
<!--</div>-->
<nav aria-label="Page navigation example">
    <ul class="pagination justify-content-center">
        <li class="page-item">
            <a class="page-link"  th:href="@{/(page=${customerList.number - 1},valueSearch=${valueSearch})}" th:if="${customerList.hasPrevious()}">Trang trước</a>
        </li>
        <li class="page-item"> <a th:each="i : ${#numbers.sequence(0, customerList.totalPages - 1)}" role="button"
                                  class="btn btn-outline-primary" th:text="${i+1}"
                                  th:href="@{/(page=${i},valueSearch=${valueSearch})}"
        ></a></li>
        <li class="page-item">
            <a  class="page-link"  th:href="@{/(page=${customerList.number + 1},valueSearch=${valueSearch})}" th:if="${customerList.hasNext()}">Trang sau</a>
        </li>
    </ul>
</nav>


<!--Modal xoá-->
<div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <form action="/delete" method="post">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel">Xóa </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <input type="hidden" id="deleteId" name="deleteId">
                    <span>Bạn có muốn xoá thông tin khách hàng : </span><span style="color: red" id="deleteName"></span> không?
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Đóng</button>
                    <button class="btn btn-danger">Xóa</button>
                </div>
            </div>
        </form>

    </div>
</div>
<script>
    // hiện thị dữ liệu lên modal xoá

    function infoDelete(id,name){
        document.getElementById("deleteId").value=id;
        document.getElementById("deleteName").innerText=name;

    Swal.fire({
        title: "Are you sure?",
        text: "You won't be able to revert this!",
        icon: "warning",
        showCancelButton: true,
        confirmButtonColor: "#3085d6",
        cancelButtonColor: "#d33",
        confirmButtonText: "Yes, delete it!"
    }).then((result) => {
        if (result.isConfirmed) {
            Swal.fire({
                title: "Deleted!",
                text: "Your file has been deleted.",
                icon: "success"
            });
        }
    });
    }

</script>
</body>
</html>
